<!DOCTYPE html>
<html lang="en">
<title>Assignment 3 Base code Adapted from W3.CSS Template</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link href='https://fonts.googleapis.com/css?family=RobotoDraft' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"><style>
html,body,h1,h2,h3,h4,h5 {font-family: "RobotoDraft", "Roboto", sans-serif}
.w3-bar-block .w3-bar-item {padding: 16px}
.selFile {display:flex}
.selFileName {flex:1 1 0%}
.selFileButton {flex:0 0 auto}
.heading {font-weight:bolder}
.invisible {visibility:hidden}
</style>
<body>

<!-- Side Navigation -->
<nav class="w3-sidebar w3-bar-block w3-collapse w3-white w3-animate-left w3-card" style="z-index:3;width:320px;" id="mySidebar">
  <a href="javascript:void(0)" class="w3-bar-item w3-button w3-border-bottom w3-xxlarge w3-center "><img src="./logo.png" style="width: 80%;">UOA Cloud</a> 
  <a href="javascript:void(0)" onclick="w3_close()" title="Close Sidemenu"
  class="w3-bar-item w3-button w3-hide-large w3-large">Close <i class="fa fa-remove"></i></a>
  <a href="javascript:void(0)" class="w3-bar-item w3-button w3-dark-grey w3-button w3-hover-black w3-left-align" onclick="document.getElementById('id01').style.display='block'"><i class="w3-padding fa fa-plus"></i>Add Files</a>
  <a id="groupsBtn" href="./Assignment3_base.html" class="w3-bar-item w3-button w3-blue"><i class="fa fa-users w3-margin-right"></i>Groups</a>
  <a id="myBtn" href="./Assignment3_files.html" class="w3-bar-item w3-button"><i class="fa fa-folder w3-margin-right"></i>My Files</a>
  <a href="#" class="w3-bar-item w3-button"><i class="fa fa-clock-o w3-margin-right"></i>Recent</a>
  <a href="#" class="w3-bar-item w3-button"><i class="fa fa-archive w3-margin-right"></i>Shared With Me</a>
  <a href="#" class="w3-bar-item w3-button"><i class="fa fa-trash w3-margin-right"></i>Trash</a>
</nav>

<!-- Modal that pops up when you click on "Share File" -->
<div id="id01" class="w3-modal" style="z-index:4">
  <div class="w3-modal-content w3-animate-zoom">
    <div class="w3-container w3-padding w3-red">
       <span onclick="cancelSharing()"
       class="w3-button w3-red w3-right w3-xxlarge"><i class="fa fa-remove"></i></span>
      <h2>Share File</h2>
    </div>
    <div class="w3-panel">
      <label>Files</label>
	  <div class="w3-section w3-border">
		<div class="w3-container selFile">
		  <span class="selFileName heading">Filename</span><span class="selFileName heading">Shared name</span><span class="w3-button selFileButton invisible w3-light-grey" id="renameWidth">Rename</span><span class="w3-button selFileButton invisible">Remove</span>
		</div>
	    <div id="fileList">
		</div>
        <input class="w3-input" type="file" multiple onchange="addFileInput(this.files)" onclick="this.value=null" id="filePicker">
	  </div>
      <label>Share with</label>
      <input class="w3-input w3-border w3-margin-bottom w3-red" type="button" value="None" data-group="" id="defaultGroup" onclick="selectLoc(this)">
	  <input class="w3-input w3-border w3-margin-bottom" type="button" value="Group - 350" data-group="350" onclick="selectLoc(this)">
	  <input class="w3-input w3-border w3-margin-bottom" type="button" value="Group - 303" data-group="303" onclick="selectLoc(this)">
	  <input class="w3-input w3-border w3-margin-bottom" type="button" value="Group - Other" data-group="Other" onclick="selectOther(this)">
	  <select class="w3-select w3-border w3-margin-bottom" onchange="selectSharing(this)" id="groupSharing" style="display:none;">
		<option>350</option>
		<option>303</option>
		<option>Per Son</option>
      </select>
      <label>Custom message</label>
      <input class="w3-input w3-border w3-margin-bottom" style="height:150px" id="shareMessage" placeholder="Message">
      <div class="w3-section">
        <a class="w3-button w3-red" onclick="cancelSharing()">Cancel  <i class="fa fa-remove"></i></a>
        <a class="w3-button w3-light-grey w3-right" onclick="doSharing(selectedFileSet, selectedGroup, document.getElementById('shareMessage').value)">Share  <i class="fa fa-paper-plane"></i></a>
      </div>
    </div>
  </div>
</div>

<!-- Overlay effect when opening the side navigation on small screens -->
<div class="w3-overlay w3-hide-large w3-animate-opacity" onclick="w3_close()" style="cursor:pointer" title="Close Sidemenu" id="myOverlay"></div>

<!-- Page content -->
<div class="w3-main" style="margin-left:320px;">
  <div id="Groups">
    <div class="w3-container w3-blue w3-center">
      <section style="float: left;"><h1 class="w3-xxxlarge">Groups</h1></section>
      <section class="w3-center" style="float:left; width: 50%; padding-left: 5%; padding-top: 1.7%;"><input class="fa w3-input w3-border w3-padding" type="text" placeholder="&#xf002; Search" style="font-size: xx-large; border-radius: 25px; height: 50px; outline: none;"></section>
    </div>
      <div style="float: left; width: 85%;">
        <div class="w3-row-padding w3-margin-top">

          <div class="w3-center w3-hover-light-grey w3-round-xxlarge" style="border: 10px solid black; margin: 2px; width: 33%; float: left;">
            <a href="javascript:void(0)" class="group w3-circle w3-jumbo"><i class="fa fa-users" style="width: 100%;"></i></a>
            <div class="w3-container">
              <h4>ENGGEN 303 Project</h4>
            </div>
          </div>
      
          <div class="w3-center w3-hover-light-grey w3-round-xxlarge" style="border: 10px solid black;  margin: 2px; width: 33%; float: left;">
            <a href="./Assignment3_SOFTENG350A3.html" class="group w3-circle w3-jumbo"><i class="fa fa-users" style="width: 100%;"></i></a>
            <div class="w3-container">
              <h4>SOFTENG 350 A3</h4>
            </div>
          </div>
      
          <div class="w3-center w3-hover-light-grey w3-round-xxlarge" style="border: 10px solid black;  margin: 2px; width: 33%; float: left;">
            <a href="javascript:void(0)" class="group w3-circle w3-jumbo"><i class="fa fa-users" style="width: 100%;"></i></a>
            <div class="w3-container">
              <h4>SOFTENG 364 G2</h4>
            </div>
          </div>

          <div class="w3-center w3-hover-light-grey" style="margin: 2px; width: 33%; float: left;">
            <a href="javascript:void(0)" class="group w3-circle w3-jumbo"><i class="fa fa-plus"></i></a>
            <div class="w3-container">
              <h4>Create New Group</h4>
            </div>
          </div>
      
        </div>

      </div>
    
    <div class="w3-border-left w3-container" style="float:right; height: 1000px; width: 15%;">
      <div class="w3-black w3-center" style="width: 100%;">
        <h1>Friends</h1>
      </div>

      <div>
        <a href="javascript:void(0)" class="w3-hover-light-grey w3-large w3-border w3-padding w3-margin-top w3-button w3-left-align" style="border-radius: 25px; width: 100%;"><i class="fa fa-user w3-margin-right"></i>Wilson Baker</a>
      </div>

      <div>
        <a href="javascript:void(0)" class="w3-hover-light-grey w3-large w3-border w3-padding w3-margin-top w3-button w3-left-align" style="border-radius: 25px; width: 100%;"><i class="fa fa-user w3-margin-right"></i>John Smith</a>
      </div>

      <div>
        <a href="javascript:void(0)" class="w3-hover-light-grey w3-large w3-border w3-padding w3-margin-top w3-button w3-left-align" style="border-radius: 25px; width: 100%;"><i class="fa fa-user w3-margin-right"></i>Leo Anderson</a>
      </div>

      <div>
        <a href="javascript:void(0)" class="w3-hover-light-grey w3-large w3-border w3-padding w3-margin-top w3-button w3-left-align" style="border-radius: 25px; width: 100%;"><i class="fa fa-user w3-margin-right"></i>Stacey Cowe</a>
      </div>

      <div>
        <a href="javascript:void(0)" class="w3-hover-light-grey w3-large w3-border w3-padding w3-margin-top w3-button w3-left-align" style="border-radius: 25px; width: 100%;"><i class="fa fa-user w3-margin-right"></i>Christopher Robin</a>
      </div>

      <div>
        <a href="javascript:void(0)" class="w3-hover-light-grey w3-large w3-border w3-padding w3-margin-top w3-button w3-left-align" style="border-radius: 25px; width: 100%;"><i class="fa fa-user w3-margin-right"></i>Terry Crews</a>
      </div>

      <div>
        <a href="javascript:void(0)" class="w3-hover-light-grey w3-large w3-border w3-padding w3-margin-top w3-button w3-left-align" style="border-radius: 25px; width: 100%;"><i class="fa fa-user w3-margin-right"></i>Angela Merkel</a>
      </div>

    </div>
  </div>
  
  

</div>

<script>
selectedFileSet = {};
lastSelLoc = document.getElementById("defaultGroup");
selectedGroup = "";

function w3_open() {
  document.getElementById("mySidebar").style.display = "block";
  document.getElementById("myOverlay").style.display = "block";
}

function w3_close() {
  document.getElementById("mySidebar").style.display = "none";
  document.getElementById("myOverlay").style.display = "none";
}

function addFileInput(files) {
	var x = document.getElementById("fileList");
	x.innerHTML = "";
	
	for (var i = 0; i < files.length; i++) {
		selectedFileSet[files[i].name] = {file:files[i],name:files[i].name};
	}
	
	for (key in selectedFileSet) {
		var file = document.createElement("div");
		var inName = document.createElement("span");
		var outName = document.createElement("span");
		var editName = document.createElement("input");
		var rename = document.createElement("a");
		var remove = document.createElement("a");
		
		editName.type = "text";
		editName.style.display = "none";
		inName.appendChild(document.createTextNode(key));
		outName.appendChild(document.createTextNode(selectedFileSet[key].name));
		outName.appendChild(editName);
		rename.appendChild(document.createTextNode("Rename"));
		remove.appendChild(document.createTextNode("Remove"));
		
		rename.addEventListener("click", function() {
			if (rename.innerText == "Rename") {
				editName.value = outName.innerText;
				rename.innerText = "Accept";
				editName.style.display = "inline";
			} else {
				rename.innerText = "Rename";
				selectedFileSet[key].name = editName.value;
				outName.innerText = editName.value;
				editName.style.display = "none";
				outName.appendChild(editName); //Apparently the last line got rid of the element so need to add it back somehow
			}
		});
		
		remove.addEventListener("click", function() {
			delete selectedFileSet[key];
			addFileInput([]);
		});
		
		inName.className="selFileName";
		outName.className="selFileName w3-light-grey";
		editName.className="w3-input w3-border w3-margin-bottom";
		rename.className="w3-button selFileButton w3-light-grey";
		remove.className="w3-button selFileButton";
		file.appendChild(inName);
		file.appendChild(outName);
		file.appendChild(rename);
		file.appendChild(remove);
		file.className="w3-container selFile";
		x.appendChild(file);
		rename.style["flex"]="0 0 "+document.getElementById("renameWidth").clientWidth+"px";
	}
	
	x.value = null;
}

function selectSharing(list) {
	selectedGroup = list.options[list.selectedIndex].label;
}

function selectLoc(loc) {
  if (lastSelLoc !== undefined) {
    lastSelLoc.className = lastSelLoc.className.replace(" w3-red","");
  }
  
  document.getElementById("groupSharing").style.display = "none";
  loc.className += " w3-red";
  selectedGroup = loc.dataset.group;
  lastSelLoc = loc;
}

function selectOther(loc) {
  if (lastSelLoc !== undefined) {
    lastSelLoc.className = lastSelLoc.className.replace(" w3-red","");
  }
  
  list = document.getElementById("groupSharing");
  list.style.display = "block";
  loc.className += " w3-red";
  selectSharing(list);
  lastSelLoc = loc;
}

function cancelSharing() {
  selectedFileSet = {};
  addFileInput([]);
  selectLoc(document.getElementById("defaultGroup"));
  document.getElementById("groupSharing").selectedIndex = 0;
  document.getElementById("shareMessage").value = null;
  document.getElementById("filePicker").value = null;
  document.getElementById('id01').style.display='none';
}

function doSharing(files, group, message) {
  console.log("sharing with \"" + group + "\" with message \"" + message + "\":");
  
  for (key in selectedFileSet) {
    console.log("\tfile: \"" + key + "\" with name \"" + selectedFileSet[key].name + "\"");
  }
  
  cancelSharing(); //Reset the popup back to how it was
}

</script>

</body>
</html>
